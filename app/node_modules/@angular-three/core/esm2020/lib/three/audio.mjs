var _NgtCommonAudio_audioArgs, _NgtCommonAudio_audio;
import { __classPrivateFieldGet, __classPrivateFieldSet } from "tslib";
import { Directive, Inject, Input, NgZone } from '@angular/core';
import * as THREE from 'three';
import { NGT_OBJECT_WATCHED_CONTROLLER, NgtObject3dController, } from '../controllers/object-3d.controller';
import * as i0 from "@angular/core";
import * as i1 from "../controllers/object-3d.controller";
export class NgtCommonAudio {
    constructor(objectController, ngZone) {
        this.objectController = objectController;
        this.ngZone = ngZone;
        _NgtCommonAudio_audioArgs.set(this, []);
        _NgtCommonAudio_audio.set(this, void 0);
        objectController.initFn = () => {
            if (!this.listener) {
                throw new Error('Cannot initialize Audio without an AudioListener');
            }
            __classPrivateFieldSet(this, _NgtCommonAudio_audio, new this.audioType(this.listener, ...__classPrivateFieldGet(this, _NgtCommonAudio_audioArgs, "f")), "f");
            return __classPrivateFieldGet(this, _NgtCommonAudio_audio, "f");
        };
    }
    set audioArgs(v) {
        __classPrivateFieldSet(this, _NgtCommonAudio_audioArgs, Array.isArray(v) ? v : [v], "f");
        this.ngZone.runOutsideAngular(() => {
            this.objectController.init();
        });
    }
    ngOnInit() {
        this.ngZone.runOutsideAngular(() => {
            if (!__classPrivateFieldGet(this, _NgtCommonAudio_audio, "f")) {
                this.objectController.init();
            }
        });
    }
    get audio() {
        return __classPrivateFieldGet(this, _NgtCommonAudio_audio, "f");
    }
}
_NgtCommonAudio_audioArgs = new WeakMap(), _NgtCommonAudio_audio = new WeakMap();
NgtCommonAudio.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: NgtCommonAudio, deps: [{ token: NGT_OBJECT_WATCHED_CONTROLLER }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Directive });
NgtCommonAudio.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "12.0.0", version: "13.0.3", type: NgtCommonAudio, inputs: { listener: "listener" }, ngImport: i0 });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.3", ngImport: i0, type: NgtCommonAudio, decorators: [{
            type: Directive
        }], ctorParameters: function () { return [{ type: i1.NgtObject3dController, decorators: [{
                    type: Inject,
                    args: [NGT_OBJECT_WATCHED_CONTROLLER]
                }] }, { type: i0.NgZone }]; }, propDecorators: { listener: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYXVkaW8uanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9wYWNrYWdlcy9jb3JlL3NyYy9saWIvdGhyZWUvYXVkaW8udHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFVLE1BQU0sZUFBZSxDQUFDO0FBQ3pFLE9BQU8sS0FBSyxLQUFLLE1BQU0sT0FBTyxDQUFDO0FBQy9CLE9BQU8sRUFDTCw2QkFBNkIsRUFDN0IscUJBQXFCLEdBQ3RCLE1BQU0scUNBQXFDLENBQUM7OztBQUk3QyxNQUFNLE9BQWdCLGNBQWM7SUFlbEMsWUFFWSxnQkFBdUMsRUFDdkMsTUFBYztRQURkLHFCQUFnQixHQUFoQixnQkFBZ0IsQ0FBdUI7UUFDdkMsV0FBTSxHQUFOLE1BQU0sQ0FBUTtRQVgxQixvQ0FBd0IsRUFBRSxFQUFDO1FBeUIzQix3Q0FBZ0I7UUFaZCxnQkFBZ0IsQ0FBQyxNQUFNLEdBQUcsR0FBRyxFQUFFO1lBQzdCLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFO2dCQUNsQixNQUFNLElBQUksS0FBSyxDQUFDLGtEQUFrRCxDQUFDLENBQUM7YUFDckU7WUFFRCx1QkFBQSxJQUFJLHlCQUFVLElBQUksSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLEdBQUcsdUJBQUEsSUFBSSxpQ0FBVyxDQUFDLE1BQUEsQ0FBQztZQUNwRSxPQUFPLHVCQUFBLElBQUksNkJBQU8sQ0FBQztRQUNyQixDQUFDLENBQUM7SUFDSixDQUFDO0lBcEJELElBQWMsU0FBUyxDQUFDLENBQXNCO1FBQzVDLHVCQUFBLElBQUksNkJBQWMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFBLENBQUM7UUFDN0MsSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7WUFDakMsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRSxDQUFDO1FBQy9CLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQztJQXFCRCxRQUFRO1FBQ04sSUFBSSxDQUFDLE1BQU0sQ0FBQyxpQkFBaUIsQ0FBQyxHQUFHLEVBQUU7WUFDakMsSUFBSSxDQUFDLHVCQUFBLElBQUksNkJBQU8sRUFBRTtnQkFDaEIsSUFBSSxDQUFDLGdCQUFnQixDQUFDLElBQUksRUFBRSxDQUFDO2FBQzlCO1FBQ0gsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDO0lBRUQsSUFBSSxLQUFLO1FBQ1AsT0FBTyx1QkFBQSxJQUFJLDZCQUFPLENBQUM7SUFDckIsQ0FBQzs7OzJHQTVDbUIsY0FBYyxrQkFnQnhCLDZCQUE2QjsrRkFoQm5CLGNBQWM7MkZBQWQsY0FBYztrQkFEbkMsU0FBUzs7MEJBaUJMLE1BQU07MkJBQUMsNkJBQTZCO2lFQVg5QixRQUFRO3NCQUFoQixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRGlyZWN0aXZlLCBJbmplY3QsIElucHV0LCBOZ1pvbmUsIE9uSW5pdCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0ICogYXMgVEhSRUUgZnJvbSAndGhyZWUnO1xuaW1wb3J0IHtcbiAgTkdUX09CSkVDVF9XQVRDSEVEX0NPTlRST0xMRVIsXG4gIE5ndE9iamVjdDNkQ29udHJvbGxlcixcbn0gZnJvbSAnLi4vY29udHJvbGxlcnMvb2JqZWN0LTNkLmNvbnRyb2xsZXInO1xuaW1wb3J0IHsgQW55Q29uc3RydWN0b3IgfSBmcm9tICcuLi90eXBlcyc7XG5cbkBEaXJlY3RpdmUoKVxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIE5ndENvbW1vbkF1ZGlvPFxuICBUQXVkaW9Ob2RlIGV4dGVuZHMgQXVkaW9Ob2RlID0gR2Fpbk5vZGUsXG4gIFRBdWRpbyBleHRlbmRzIFRIUkVFLkF1ZGlvPFRBdWRpb05vZGU+ID0gVEhSRUUuQXVkaW88VEF1ZGlvTm9kZT5cbj4gaW1wbGVtZW50cyBPbkluaXRcbntcbiAgQElucHV0KCkgbGlzdGVuZXIhOiBUSFJFRS5BdWRpb0xpc3RlbmVyO1xuXG4gICNhdWRpb0FyZ3M6IHVua25vd25bXSA9IFtdO1xuICBwcm90ZWN0ZWQgc2V0IGF1ZGlvQXJncyh2OiB1bmtub3duIHwgdW5rbm93bltdKSB7XG4gICAgdGhpcy4jYXVkaW9BcmdzID0gQXJyYXkuaXNBcnJheSh2KSA/IHYgOiBbdl07XG4gICAgdGhpcy5uZ1pvbmUucnVuT3V0c2lkZUFuZ3VsYXIoKCkgPT4ge1xuICAgICAgdGhpcy5vYmplY3RDb250cm9sbGVyLmluaXQoKTtcbiAgICB9KTtcbiAgfVxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIEBJbmplY3QoTkdUX09CSkVDVF9XQVRDSEVEX0NPTlRST0xMRVIpXG4gICAgcHJvdGVjdGVkIG9iamVjdENvbnRyb2xsZXI6IE5ndE9iamVjdDNkQ29udHJvbGxlcixcbiAgICBwcm90ZWN0ZWQgbmdab25lOiBOZ1pvbmVcbiAgKSB7XG4gICAgb2JqZWN0Q29udHJvbGxlci5pbml0Rm4gPSAoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMubGlzdGVuZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgaW5pdGlhbGl6ZSBBdWRpbyB3aXRob3V0IGFuIEF1ZGlvTGlzdGVuZXInKTtcbiAgICAgIH1cblxuICAgICAgdGhpcy4jYXVkaW8gPSBuZXcgdGhpcy5hdWRpb1R5cGUodGhpcy5saXN0ZW5lciwgLi4udGhpcy4jYXVkaW9BcmdzKTtcbiAgICAgIHJldHVybiB0aGlzLiNhdWRpbztcbiAgICB9O1xuICB9XG5cbiAgYWJzdHJhY3QgYXVkaW9UeXBlOiBBbnlDb25zdHJ1Y3RvcjxUQXVkaW8+O1xuXG4gICNhdWRpbyE6IFRBdWRpbztcblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBpZiAoIXRoaXMuI2F1ZGlvKSB7XG4gICAgICAgIHRoaXMub2JqZWN0Q29udHJvbGxlci5pbml0KCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBnZXQgYXVkaW8oKSB7XG4gICAgcmV0dXJuIHRoaXMuI2F1ZGlvO1xuICB9XG59XG4iXX0=