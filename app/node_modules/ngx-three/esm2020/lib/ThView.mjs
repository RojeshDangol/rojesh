import { Component, ContentChild, EventEmitter, forwardRef, Input, Output } from '@angular/core';
import { Vector4 } from 'three';
import { RaycasterService } from './events/raycaster.service';
import { ThCamera } from './generated/ThCamera';
import { ThObject3D } from './generated/ThObject3D';
import { ThScene } from './generated/ThScene';
import * as i0 from "@angular/core";
import * as i1 from "./ThEngine.service";
import * as i2 from "./events/raycaster.service";
// eslint-disable-next-line @angular-eslint/component-class-suffix
export class ThView {
    constructor(engServ, raycaster) {
        this.engServ = engServ;
        this.raycaster = raycaster;
        // -----------------------------------------------------------------------------------------------
        // eslint-disable-next-line @angular-eslint/no-output-on-prefix
        this.onRender = new EventEmitter();
    }
    set contentScene(scene) {
        if (scene) {
            this.scene = scene;
        }
    }
    set effectComposer(effectComposer) {
        this._effectComposer = effectComposer;
        this.configureEffectComposerRenderTarget();
    }
    get effectComposer() {
        return this._effectComposer;
    }
    set camera(camera) {
        this._camera = camera;
        this.initRaycaster();
    }
    get camera() {
        return this._camera;
    }
    set contentCamera(camera) {
        if (camera) {
            this.camera = camera;
        }
    }
    set viewPort(viewPort) {
        this._viewPort = viewPort;
        this.configureEffectComposerRenderTarget();
    }
    get viewPort() {
        return this._viewPort;
    }
    ngOnInit() {
        this.initRaycaster();
    }
    initRaycaster() {
        if (this.camera && this.engServ.canvas) {
            this.raycaster.init(this.camera, this.engServ.canvas);
        }
    }
    add(scene) {
        // nothing to do here
    }
    remove(scene) {
        // norhing to do
    }
    configureEffectComposerRenderTarget() {
        if (!this.viewPort || !this.effectComposer) {
            return;
        }
        else {
            let width;
            let height;
            if (this.viewPort instanceof Vector4) {
                width = this.viewPort.z;
                height = this.viewPort?.width;
            }
            else {
                width = this.viewPort.width;
                height = this.viewPort.height;
            }
            //TODO: check if pixel ration ha
            this.effectComposer.setSize(width, height);
        }
    }
}
ThView.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "13.0.2", ngImport: i0, type: ThView, deps: [{ token: i1.ThEngineService }, { token: i2.RaycasterService }], target: i0.ɵɵFactoryTarget.Component });
ThView.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "12.0.0", version: "13.0.2", type: ThView, selector: "th-view", inputs: { scene: "scene", effectComposer: "effectComposer", camera: "camera", shadow: "shadow", viewPort: "viewPort", scissor: "scissor", scissorTest: "scissorTest", clearColor: "clearColor", clearAlpha: "clearAlpha" }, outputs: { onRender: "onRender" }, providers: [{ provide: ThObject3D, useExisting: forwardRef(() => ThView) }, RaycasterService], queries: [{ propertyName: "contentScene", first: true, predicate: ThScene, descendants: true }, { propertyName: "contentCamera", first: true, predicate: ThCamera, descendants: true }], ngImport: i0, template: '', isInline: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "13.0.2", ngImport: i0, type: ThView, decorators: [{
            type: Component,
            args: [{
                    selector: 'th-view',
                    template: '',
                    providers: [{ provide: ThObject3D, useExisting: forwardRef(() => ThView) }, RaycasterService]
                }]
        }], ctorParameters: function () { return [{ type: i1.ThEngineService }, { type: i2.RaycasterService }]; }, propDecorators: { scene: [{
                type: Input
            }], contentScene: [{
                type: ContentChild,
                args: [ThScene]
            }], effectComposer: [{
                type: Input
            }], camera: [{
                type: Input
            }], contentCamera: [{
                type: ContentChild,
                args: [ThCamera]
            }], shadow: [{
                type: Input
            }], viewPort: [{
                type: Input
            }], scissor: [{
                type: Input
            }], scissorTest: [{
                type: Input
            }], clearColor: [{
                type: Input
            }], clearAlpha: [{
                type: Input
            }], onRender: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVGhWaWV3LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vcHJvamVjdHMvbmd4LXRocmVlL3NyYy9saWIvVGhWaWV3LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxTQUFTLEVBQUUsWUFBWSxFQUFFLFlBQVksRUFBRSxVQUFVLEVBQUUsS0FBSyxFQUFVLE1BQU0sRUFBRSxNQUFNLGVBQWUsQ0FBQztBQUN6RyxPQUFPLEVBQW1CLE9BQU8sRUFBRSxNQUFNLE9BQU8sQ0FBQztBQUVqRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQztBQUM5RCxPQUFPLEVBQUUsUUFBUSxFQUFFLE1BQU0sc0JBQXNCLENBQUM7QUFDaEQsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLHdCQUF3QixDQUFDO0FBQ3BELE9BQU8sRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQzs7OztBQVM5QyxrRUFBa0U7QUFDbEUsTUFBTSxPQUFPLE1BQU07SUFRakIsWUFBc0IsT0FBd0IsRUFBWSxTQUEyQjtRQUEvRCxZQUFPLEdBQVAsT0FBTyxDQUFpQjtRQUFZLGNBQVMsR0FBVCxTQUFTLENBQWtCO1FBOEVyRixrR0FBa0c7UUFFbEcsK0RBQStEO1FBRS9DLGFBQVEsR0FBRyxJQUFJLFlBQVksRUFJdkMsQ0FBQztJQXRGbUYsQ0FBQztJQUt6RixJQUNXLFlBQVksQ0FBQyxLQUEwQjtRQUNoRCxJQUFJLEtBQUssRUFBRTtZQUNULElBQUksQ0FBQyxLQUFLLEdBQUcsS0FBSyxDQUFDO1NBQ3BCO0lBQ0gsQ0FBQztJQUVELElBQ1csY0FBYyxDQUFDLGNBQTBDO1FBQ2xFLElBQUksQ0FBQyxlQUFlLEdBQUcsY0FBYyxDQUFDO1FBQ3RDLElBQUksQ0FBQyxtQ0FBbUMsRUFBRSxDQUFDO0lBQzdDLENBQUM7SUFFRCxJQUFXLGNBQWM7UUFDdkIsT0FBTyxJQUFJLENBQUMsZUFBZSxDQUFDO0lBQzlCLENBQUM7SUFF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S0FBSztnQkFPTixVQUFVO3NCQURULEtBQUs7Z0JBTVUsUUFBUTtzQkFEdkIsTUFBTSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgQ29udGVudENoaWxkLCBFdmVudEVtaXR0ZXIsIGZvcndhcmRSZWYsIElucHV0LCBPbkluaXQsIE91dHB1dCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQ29sb3IsIE9iamVjdDNELCBWZWN0b3I0IH0gZnJvbSAndGhyZWUnO1xuaW1wb3J0IHsgRWZmZWN0Q29tcG9zZXIgfSBmcm9tICd0aHJlZS9leGFtcGxlcy9qc20vcG9zdHByb2Nlc3NpbmcvRWZmZWN0Q29tcG9zZXInO1xuaW1wb3J0IHsgUmF5Y2FzdGVyU2VydmljZSB9IGZyb20gJy4vZXZlbnRzL3JheWNhc3Rlci5zZXJ2aWNlJztcbmltcG9ydCB7IFRoQ2FtZXJhIH0gZnJvbSAnLi9nZW5lcmF0ZWQvVGhDYW1lcmEnO1xuaW1wb3J0IHsgVGhPYmplY3QzRCB9IGZyb20gJy4vZ2VuZXJhdGVkL1RoT2JqZWN0M0QnO1xuaW1wb3J0IHsgVGhTY2VuZSB9IGZyb20gJy4vZ2VuZXJhdGVkL1RoU2NlbmUnO1xuaW1wb3J0IHsgVGhFbmdpbmVTZXJ2aWNlIH0gZnJvbSAnLi9UaEVuZ2luZS5zZXJ2aWNlJztcblxuXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICd0aC12aWV3JyxcbiAgdGVtcGxhdGU6ICcnLFxuICBwcm92aWRlcnM6IFt7IHByb3ZpZGU6IFRoT2JqZWN0M0QsIHVzZUV4aXN0aW5nOiBmb3J3YXJkUmVmKCgpID0+IFRoVmlldykgfSwgUmF5Y2FzdGVyU2VydmljZV1cbn0pXG4vLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQGFuZ3VsYXItZXNsaW50L2NvbXBvbmVudC1jbGFzcy1zdWZmaXhcbmV4cG9ydCBjbGFzcyBUaFZpZXcgaW1wbGVtZW50cyBPbkluaXQge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25hbWluZy1jb252ZW50aW9uLCBuby11bmRlcnNjb3JlLWRhbmdsZSwgaWQtYmxhY2tsaXN0LCBpZC1tYXRjaFxuICBwcm90ZWN0ZWQgX2NhbWVyYT86IFRoQ2FtZXJhO1xuICBwcm90ZWN0ZWQgX3ZpZXdQb3J0PzogVmVjdG9yNCB8IHsgeDogbnVtYmVyOyB5OiBudW1iZXI7IHdpZHRoOiBudW1iZXI7IGhlaWdodDogbnVtYmVyIH07XG5cblxuICBwcm90ZWN0ZWQgX2VmZmVjdENvbXBvc2VyPzogRWZmZWN0Q29tcG9zZXI7XG5cbiAgY29uc3RydWN0b3IocHJvdGVjdGVkIGVuZ1NlcnY6IFRoRW5naW5lU2VydmljZSwgcHJvdGVjdGVkIHJheWNhc3RlcjogUmF5Y2FzdGVyU2VydmljZSkge31cblxuICBASW5wdXQoKVxuICBwdWJsaWMgc2NlbmU/OiBUaFNjZW5lO1xuXG4gIEBDb250ZW50Q2hpbGQoVGhTY2VuZSlcbiAgcHVibGljIHNldCBjb250ZW50U2NlbmUoc2NlbmU6IFRoU2NlbmUgfCB1bmRlZmluZWQpIHtcbiAgICBpZiAoc2NlbmUpIHtcbiAgICAgIHRoaXMuc2NlbmUgPSBzY2VuZTtcbiAgICB9XG4gIH1cblxuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IGVmZmVjdENvbXBvc2VyKGVmZmVjdENvbXBvc2VyOiBFZmZlY3RDb21wb3NlciB8IHVuZGVmaW5lZCkge1xuICAgIHRoaXMuX2VmZmVjdENvbXBvc2VyID0gZWZmZWN0Q29tcG9zZXI7XG4gICAgdGhpcy5jb25maWd1cmVFZmZlY3RDb21wb3NlclJlbmRlclRhcmdldCgpO1xuICB9XG5cbiAgcHVibGljIGdldCBlZmZlY3RDb21wb3NlcigpIHtcbiAgICByZXR1cm4gdGhpcy5fZWZmZWN0Q29tcG9zZXI7XG4gIH1cblxuICBASW5wdXQoKVxuICBwdWJsaWMgc2V0IGNhbWVyYShjYW1lcmE6IFRoQ2FtZXJhIHwgdW5kZWZpbmVkKSB7XG4gICAgdGhpcy5fY2FtZXJhID0gY2FtZXJhO1xuICAgIHRoaXMuaW5pdFJheWNhc3RlcigpO1xuICB9XG5cbiAgcHVibGljIGdldCBjYW1lcmEoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2NhbWVyYTtcbiAgfVxuXG4gIEBDb250ZW50Q2hpbGQoVGhDYW1lcmEpXG4gIHB1YmxpYyBzZXQgY29udGVudENhbWVyYShjYW1lcmE6IFRoQ2FtZXJhPGFueT4gfCB1bmRlZmluZWQpIHtcbiAgICBpZiAoY2FtZXJhKSB7XG4gICAgICB0aGlzLmNhbWVyYSA9IGNhbWVyYTtcbiAgICB9XG4gIH1cblxuICAvLyByZW5kZXJlciBwYXJhbWV0ZXJzXG4gIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gIC8qKlxuICAgKiBlbmFibGUgLyBkaXNhYmxlIHNoYWRvd3NcbiAgICovXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzaGFkb3c/OiBib29sZWFuO1xuXG4gIEBJbnB1dCgpXG4gIHB1YmxpYyBzZXQgdmlld1BvcnQodmlld1BvcnQ6IFZlY3RvcjQgfCB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9IHwgdW5kZWZpbmVkICkge1xuICAgIHRoaXMuX3ZpZXdQb3J0ID0gdmlld1BvcnQ7XG4gICAgdGhpcy5jb25maWd1cmVFZmZlY3RDb21wb3NlclJlbmRlclRhcmdldCgpO1xuICB9XG5cbiAgcHVibGljIGdldCB2aWV3UG9ydCgpIHtcbiAgICByZXR1cm4gdGhpcy5fdmlld1BvcnQ7XG4gIH1cblxuICBASW5wdXQoKVxuICBwdWJsaWMgc2Npc3Nvcj86IFZlY3RvcjQgfCB7IHg6IG51bWJlcjsgeTogbnVtYmVyOyB3aWR0aDogbnVtYmVyOyBoZWlnaHQ6IG51bWJlciB9O1xuXG4gIC8qKlxuICAgKiBFbmFibGUgdGhlIHNjaXNzb3IgdGVzdC4gV2hlbiB0aGlzIGlzIGVuYWJsZWQsXG4gICAqIG9ubHkgdGhlIHBpeGVscyB3aXRoaW4gdGhlIGRlZmluZWQgc2Npc3NvciBhcmVhIHdpbGwgYmUgYWZmZWN0ZWQgYnkgZnVydGhlciByZW5kZXJlciBhY3Rpb25zLlxuICAgKi9cbiAgQElucHV0KClcbiAgcHVibGljIHNjaXNzb3JUZXN0PzogYm9vbGVhbjtcblxuICAvKipcbiAgICogU2V0cyB0aGUgY2xlYXIgY29sb3JcbiAgICovXG4gIEBJbnB1dCgpXG4gIGNsZWFyQ29sb3I/OiBDb2xvciB8IHN0cmluZyB8IG51bWJlcjtcblxuICAvKipcbiAgICogYSBmbG9hdCB3aXRoIHRoZSBjdXJyZW50IGNsZWFyIGFscGhhLiBSYW5nZXMgZnJvbSAwIHRvIDEuXG4gICAqL1xuICBASW5wdXQoKVxuICBjbGVhckFscGhhPzogbnVtYmVyO1xuICAvLyAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAYW5ndWxhci1lc2xpbnQvbm8tb3V0cHV0LW9uLXByZWZpeFxuICBAT3V0cHV0KClcbiAgcHVibGljIHJlYWRvbmx5IG9uUmVuZGVyID0gbmV3IEV2ZW50RW1pdHRlcjx7XG4gICAgcmVuZGVyZXI6IFRIUkVFLldlYkdMUmVuZGVyZXI7XG4gICAgc2NlbmU6IFRoU2NlbmU7XG4gICAgY2FtZXJhOiBUaENhbWVyYTtcbiAgfT4oKTtcblxuICBuZ09uSW5pdCgpOiB2b2lkIHtcbiAgICB0aGlzLmluaXRSYXljYXN0ZXIoKTtcbiAgfVxuXG4gIHByaXZhdGUgaW5pdFJheWNhc3RlcigpIHtcbiAgICBpZiAodGhpcy5jYW1lcmEgJiYgdGhpcy5lbmdTZXJ2LmNhbnZhcykge1xuICAgICAgdGhpcy5yYXljYXN0ZXIuaW5pdCh0aGlzLmNhbWVyYSwgdGhpcy5lbmdTZXJ2LmNhbnZhcyk7XG4gICAgfVxuICB9XG5cbiAgYWRkKHNjZW5lOiBPYmplY3QzRCkge1xuICAgIC8vIG5vdGhpbmcgdG8gZG8gaGVyZVxuICB9XG5cbiAgcmVtb3ZlKHNjZW5lOiBPYmplY3QzRCkge1xuICAgIC8vIG5vcmhpbmcgdG8gZG9cbiAgfVxuXG4gIHByaXZhdGUgY29uZmlndXJlRWZmZWN0Q29tcG9zZXJSZW5kZXJUYXJnZXQoKSB7XG4gICAgaWYgKCF0aGlzLnZpZXdQb3J0IHx8ICF0aGlzLmVmZmVjdENvbXBvc2VyKSB7XG4gICAgICByZXR1cm47XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCB3aWR0aDogbnVtYmVyO1xuICAgICAgbGV0IGhlaWdodDogbnVtYmVyO1xuICAgICAgaWYgKHRoaXMudmlld1BvcnQgaW5zdGFuY2VvZiBWZWN0b3I0KSB7XG4gICAgICAgIHdpZHRoID0gdGhpcy52aWV3UG9ydC56O1xuICAgICAgICBoZWlnaHQgPSB0aGlzLnZpZXdQb3J0Py53aWR0aDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHdpZHRoID0gdGhpcy52aWV3UG9ydC53aWR0aDtcbiAgICAgICAgaGVpZ2h0ID0gdGhpcy52aWV3UG9ydC5oZWlnaHQ7XG4gICAgICB9XG4gICAgICAvL1RPRE86IGNoZWNrIGlmIHBpeGVsIHJhdGlvbiBoYVxuICAgICAgdGhpcy5lZmZlY3RDb21wb3Nlci5zZXRTaXplKHdpZHRoLCBoZWlnaHQpO1xuICAgIH1cbiAgfVxufVxuIl19